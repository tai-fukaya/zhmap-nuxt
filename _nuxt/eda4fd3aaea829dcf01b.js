(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{192:function(t,e,r){var content=r(207);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(43).default)("493aa800",content,!0,{sourceMap:!1})},193:function(t,e,r){var content=r(209);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(43).default)("645bf471",content,!0,{sourceMap:!1})},206:function(t,e,r){"use strict";var n=r(192);r.n(n).a},207:function(t,e,r){(e=r(42)(!1)).push([t.i,".map-view[data-v-6b4a2da6]{width:100%;position:fixed;top:0;left:0;z-index:-1}",""]),t.exports=e},208:function(t,e,r){"use strict";var n=r(193);r.n(n).a},209:function(t,e,r){(e=r(42)(!1)).push([t.i,".search-result[data-v-7c96c780]{margin:0 20px}.search-result-title[data-v-7c96c780]{width:100px;display:inline-block;text-align:right;vertical-align:bottom}.search-bar[data-v-7c96c780]{width:100%;padding:0 20px}.search-word[data-v-7c96c780]{display:inline-block;width:100%;border:0;border-bottom:1px solid #000;font-family:Courier New,monospace}.search-word[data-v-7c96c780]:focus{outline:none;border:1px solid #000}",""]),t.exports=e},210:function(t,e,r){"use strict";r.r(e);r(30);var n=r(3),o=(r(197),r(201),r(204),r(109)),h=r(110),c=r(205),l=function(){function t(e){Object(o.a)(this,t),this.width=2*window.innerWidth,this.height=2*window.innerHeight,this.mapData=[],this.searchedIds=[],this.cameraFov=60;var r=this.height/2*Math.sqrt(3);this.renderer=new c.h({canvas:e,alpha:!0}),this.renderer.setSize(this.width,this.height),this.renderer.setClearColor(0,0),this.renderer.domElement.style.transform="scale(0.5)",this.renderer.domElement.style.transformOrigin="left top",this.scene=new c.f,this.camera=new c.c(this.cameraFov,this.width/this.height,.1,r),this.camera.position.z=r,this.initGeometry(),window.addEventListener("resize",this.resize.bind(this)),this.loop()}return Object(h.a)(t,[{key:"loop",value:function(){this.render(),requestAnimationFrame(this.loop.bind(this))}},{key:"render",value:function(){this.renderer.render(this.scene,this.camera)}},{key:"resize",value:function(){console.log("resize"),this.width=2*window.innerWidth,this.height=2*window.innerHeight,this.camera.aspect=this.width/this.height,this.camera.position.z=this.height/2*Math.sqrt(3),this.camera.updateProjectionMatrix(),this.calcurateGeometry(),this.renderer.setSize(this.width,this.height)}},{key:"showSearchResult",value:function(t,e){this.mapData=t,this.searchedIds=e,this.calcurateGeometry()}},{key:"initGeometry",value:function(){var t=new c.b,e=new c.e({size:2,vertexColors:c.g}),r=new c.d(t,e);r.position.x=-this.width/2,r.position.y=-this.height/2,r.visible=!1,this.particle=r,this.scene.add(this.particle)}},{key:"calcurateGeometry",value:function(){console.log("calcurate");var t=0,e=Number.MAX_SAFE_INTEGER,r=0,n=Number.MAX_SAFE_INTEGER;this.mapData.forEach((function(data){data.searched&&(data.latitude>t&&(t=data.latitude),data.latitude<e&&(e=data.latitude),data.longitude>r&&(r=data.longitude),data.longitude<n&&(n=data.longitude))})),0===t?this.mapData.forEach((function(data){data.latitude>t&&(t=data.latitude),data.latitude<e&&(e=data.latitude),data.longitude>r&&(r=data.longitude),data.longitude<n&&(n=data.longitude)})):(e-=8e7,t+=8e7),console.log(t,e,r,n);var o=this.mapData.length,h=this.width/(r-n),l=this.height/(t-e),d=Math.min(h,l),m=(this.width-(r-n)*d)/2,v=(this.height-(t-e)*d)/2;console.log(this.width,m,this.height,v,h,l,d);var f=new Float32Array(3*o),w=new Float32Array(3*o);this.mapData.forEach((function(data,i){var t=3*i;f[t+0]=f[t+1]=f[t+2]=.7,data.searched&&(f[t+0]=1,f[t+1]=0,f[t+2]=0),w[t+0]=Math.floor(m+(data.longitude-n)*d),w[t+1]=Math.floor(v+(data.latitude-e)*d),w[t+2]=0})),this.particle.geometry.setAttribute("color",new c.a(f,3)),this.particle.geometry.setAttribute("position",new c.a(w,3)),this.particle.position.x=-this.width/2,this.particle.position.y=-this.height/2,this.particle.visible=!0}}]),t}(),d={props:{mapItems:{type:Array,default:function(){return[]}}},watch:{mapItems:function(t,e){this.canvas.showSearchResult(t,this.$props.searchedIds)}},mounted:function(){this.canvas=new l(this.$refs.canvas)}},m=(r(206),r(18)),v={components:{TheMapView:Object(m.a)(d,(function(){var t=this.$createElement;return(this._self._c||t)("canvas",{ref:"canvas",staticClass:"map-view"})}),[],!1,null,"6b4a2da6",null).exports},computed:{mapItems:function(){return this.$store.getters.items},totalCount:function(){return this.$store.getters.totalCount},searchCount:function(){return this.$store.getters.searchCount},firstSearchedItem:function(){return this.$store.getters.firstSearchedItem}},mounted:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.$store.dispatch("downloadData");case 1:case"end":return e.stop()}}),e)})))()},methods:{searchMap:function(){this.$store.commit("search",event.target.value)}},head:function(){return{title:"Chinese Map Search",meta:[{name:"twitter:title",content:"Chinese Map Search"},{name:"twitter:description",content:"Search chinese map by areacode"},{name:"twitter:image",content:"https://i.imgur.com/UYP2umJ.png"},{name:"twitter:card",content:"summary_large_image"}]}}},f=(r(208),Object(m.a)(v,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container"},[r("div",{staticClass:"search-bar"},[r("input",{staticClass:"search-word",attrs:{placeholder:"110101002(area code), k: Keyword, m: Ministry Name, p:, c:, t:"},on:{keyup:t.searchMap}})]),t._v(" "),r("div",{staticClass:"search-result"},[r("p",[r("span",{staticClass:"search-result-title"},[t._v("Result:")]),t._v(" "+t._s(t.searchCount)+" /\n      "+t._s(t.totalCount)+"\n    ")]),t._v(" "),r("p",[r("span",{staticClass:"search-result-title"},[t._v("Area Code:")]),t._v("\n      "+t._s(t.firstSearchedItem.displayId)+"\n    ")]),t._v(" "),r("p",[r("span",{staticClass:"search-result-title"},[t._v("Ministry:")]),t._v("\n      "+t._s(t.firstSearchedItem.ministry)+"\n    ")]),t._v(" "),r("p",[r("span",{staticClass:"search-result-title"},[t._v("Province:")]),t._v("\n      "+t._s(t.firstSearchedItem.province)+"\n    ")]),t._v(" "),r("p",[r("span",{staticClass:"search-result-title"},[t._v("City:")]),t._v("\n      "+t._s(t.firstSearchedItem.city)+"\n    ")]),t._v(" "),r("p",[r("span",{staticClass:"search-result-title"},[t._v("Town:")]),t._v("\n      "+t._s(t.firstSearchedItem.town)+"\n    ")]),t._v(" "),r("p",[r("span",{staticClass:"search-result-title"},[t._v("Latitude:")]),t._v("\n      "+t._s(t.firstSearchedItem.showLatitude.toFixed(7))+"\n    ")]),t._v(" "),r("p",[r("span",{staticClass:"search-result-title"},[t._v("Longitude:")]),t._v("\n      "+t._s(t.firstSearchedItem.showLongitude.toFixed(7))+"\n    ")])]),t._v(" "),r("the-map-view",{attrs:{"map-items":t.mapItems}})],1)}),[],!1,null,"7c96c780",null));e.default=f.exports}}]);